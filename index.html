<!DOCTYPE html>
<html lang="en">

<head>
    <!-- This is a comment
purpose:  -->
    <title>San Francisco Hiking Helper App</title>
    <meta name="description" content="Hiking Helper App">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/app.css">

    <script src="js/trailsData.js"></script>

<style>

td {
	padding: 0px;
}

</style>

<!-- copy pasted form one of the map pages -->
<meta name="viewport" content="initial-scale=1.0, user-scalable=no">

<style>
  /* Always set the map height explicitly to define the size of the div
   * element that contains the map. */
  #map {
    height: 100%;
  }

</style>

</head>

<body class="center">

        <header class="center">
            <img class="B" src="images/banner/panorama.jpg" alt="San Francisco">

            <div class="abs">
                <img class="L" src="images/logo/h2.png" alt="Logo">
            </div>

            <div class="name">
                San Francisco<br>Hiking Helper
            </div>

            <div class="top_right">
                <ul class="h">
                    <li class="h"><a class="h" href="imgmap2.html" onclick="window.open('imgmap2.html', 'newwindow',
	'width=700,height=400');
	 return false;">Weather</a></li>
                    <li class="h"><a class="h" href="app.html">Weather2</a></li>
                </ul>
            </div>

        </header>

        <!-- listing of top 10 SF hikes; see trailLinks below -->
		<table class="t">
		  <tr>
		    <td class="td" width="30%">
				<ul class="fr" id="trailLinks">
                </ul>
		    </td>

			<td class="td" width="70%" id="map">

            </td>
		  </tr>

		</table>


            <footer class="copyright">
                <br> Contact us: <a href="mailto:igolovko@mail.ccsf.edu">igolovko@mail.ccsf.edu</a>
                <br> Copyright &copy; San Francisco Hiking Helper, 2018

                <script>
                    var dateModified = document.lastModified;
                    mydate = dateModified.slice(0, 16);
                    document.write("| Last updated: " + mydate);

                </script>

            </footer>

            <script>
              var map = undefined;

              var markers = [];    // array of markers

              // sets all, but current marker to null so that only 1 marker is shown
              // center of map is shown at marker's position
              function switchToMarker(markerIndex) {
                  for (var i = 0; i < markers.length; i++) {
                        markers[i].setMap(null);
                   }
                   markers[markerIndex].setMap(map);

                   map.setCenter(markers[markerIndex].position);
              }

              function makeMarker(map, trailData) {
                 var infowindow = new google.maps.InfoWindow({
                   content: trailData.contentString
                 });

                 var marker = new google.maps.Marker({
                   position: trailData.coordinate,
                   title: trailData.title
                 });
                 marker.addListener('click', function() {
                   infowindow.open(map, marker);
                 });

                 return marker;
              }

              function initMap() {
                  console.log("Initializing map...");

                  console.log(document.ALL_TRAILS);

                    // instantiate Google Map widget.
                  map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 14
                  });

                // create all the markers; placed in separate file (trailsData)
                for (var i = 0; i < document.ALL_TRAILS.length; i++) {
                    markers.push(
                        makeMarker(
                            map,
                            document.ALL_TRAILS[i]
                        )
                    );
                }

                // generate links to hikes dynamically.
                var trailLinksHtml = '<li class="n">Top Hikes</li>';
                var trailLinksDomElement = document.getElementById('trailLinks');

                for (var i = 0; i < document.ALL_TRAILS.length; i++) {
                    var trailData = document.ALL_TRAILS[i];
                    // create html for single link.  We pass it call back with the right marker index because we are in inner loop and we know the right index.
                    var linkHtml = '<li class="r"><a onClick="switchToMarker(' + i + ');">' + (i+1) + '. ' + trailData.title + '</a></li>';

                    trailLinksHtml += linkHtml;
                }

                trailLinksDomElement.innerHTML = trailLinksHtml;

                   switchToMarker(9);
              }

            </script>
            <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAxP9I-vgyRuABmAZiRu_rg-iKqcRs9M6w&callback=initMap">
            </script>

</body>

</html>
